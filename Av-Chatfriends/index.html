
 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>AI Chat - Local ChatGPT Interface</title>
   
 <style>
     :root {
         --bg-color: #0f0f11;
         --chat-bg: #1a1a1d;
         --assistant-bg: #222327;
         --user-bg: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
         --border-color: #2e2e32;
         --text-primary: #f5f5f7;
         --text-secondary: #b0b0b5;
         --accent: #6366f1;
         --radius-lg: 22px;
         --radius-md: 12px;
         --radius-sm: 8px;
         --shadow-soft: 0 4px 24px rgba(0, 0, 0, 0.5);
     }
 
     * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
     }
 
     body {
         font-family: "Inter", "Segoe UI", system-ui, sans-serif;
         background: var(--bg-color);
         height: 100vh;
         display: flex;
         justify-content: center;
         align-items: center;
         padding: 20px;
         color: var(--text-primary);
     }
 
     /* --- Main Container --- */
     .chat-container {
         width: 100%;
         max-width: 900px;
         height: 90vh;
         background: var(--chat-bg);
         border-radius: var(--radius-lg);
         box-shadow: var(--shadow-soft);
         display: flex;
         flex-direction: column;
         overflow: hidden;
         border: 1px solid var(--border-color);
     }
 
     /* --- Header --- */
     .chat-header {
         background: rgba(34, 35, 39, 0.85);
         backdrop-filter: blur(12px);
         color: var(--text-primary);
         padding: 20px;
         text-align: center;
         font-size: 22px;
         font-weight: 600;
         border-bottom: 1px solid var(--border-color);
         position: relative;
         box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
     }
 
     .status-indicator {
         position: absolute;
         top: 20px;
         right: 25px;
         width: 12px;
         height: 12px;
         border-radius: 50%;
         background: #22c55e;
         box-shadow: 0 0 10px rgba(34, 197, 94, 0.6);
     }
 
     .status-indicator.disconnected {
         background: #ef4444;
         box-shadow: 0 0 10px rgba(239, 68, 68, 0.6);
     }
 
     /* --- Messages --- */
     .chat-messages {
         flex: 1;
         overflow-y: auto;
         padding: 28px 22px;
         background: var(--chat-bg);
         scroll-behavior: smooth;
     }
 
     .message {
         display: flex;
         margin-bottom: 18px;
         animation: fadeIn 0.3s ease;
     }
 
     .message.user {
         justify-content: flex-end;
     }
 
     .message.assistant {
         justify-content: flex-start;
     }
 
     .message-content {
         max-width: 75%;
         padding: 14px 18px;
         border-radius: var(--radius-lg);
         word-wrap: break-word;
         line-height: 1.6;
         font-size: 15px;
         box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
         transition: transform 0.2s ease;
     }
 
     .message.user .message-content {
         background: var(--user-bg);
         color: #fff;
         border-bottom-right-radius: var(--radius-sm);
     }
 
     .message.assistant .message-content {
         background: var(--assistant-bg);
         color: var(--text-primary);
         border: 1px solid var(--border-color);
         border-bottom-left-radius: var(--radius-sm);
     }
 
     .message-content:hover {
         transform: scale(1.02);
     }
 
     @keyframes fadeIn {
         from { opacity: 0; transform: translateY(10px); }
         to { opacity: 1; transform: translateY(0); }
     }
 
     /* --- Input Section --- */
     .chat-input-container {
         padding: 20px;
         background: var(--assistant-bg);
         border-top: 1px solid var(--border-color);
     }
 
     .chat-input-wrapper {
         display: flex;
         align-items: flex-end;
         gap: 10px;
         background: #2a2b31;
         border-radius: 50px;
         padding: 8px 14px;
         border: 1px solid var(--border-color);
     }
 
     .chat-input {
         flex: 1;
         border: none;
         background: transparent;
         resize: none;
         font-size: 16px;
         color: var(--text-primary);
         line-height: 1.5;
         outline: none;
         padding: 8px 12px;
         font-family: inherit;
     }
 
     .chat-input::placeholder {
         color: var(--text-secondary);
     }
 
     .send-button {
         background: var(--user-bg);
         color: #fff;
         border: none;
         border-radius: 50px;
         font-weight: 600;
         font-size: 16px;
         padding: 12px 24px;
         cursor: pointer;
         transition: all 0.25s ease;
     }
 
     .send-button:hover:not(:disabled) {
         transform: translateY(-2px);
         box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5);
     }
 
     .send-button:disabled {
         opacity: 0.6;
         cursor: not-allowed;
     }
 
     /* --- Loading Spinner --- */
     .loading {
         display: inline-block;
         width: 22px;
         height: 22px;
         border: 3px solid rgba(255, 255, 255, 0.15);
         border-top-color: var(--accent);
         border-radius: 50%;
         animation: spin 1s linear infinite;
     }
 
     @keyframes spin {
         to { transform: rotate(360deg); }
     }
 
     /* --- Error Messages --- */
     .error-message {
         background: rgba(239, 68, 68, 0.15);
         color: #f87171;
         border: 1px solid rgba(239, 68, 68, 0.3);
         border-radius: var(--radius-md);
         padding: 12px 16px;
     }
 
     /* --- Scrollbar --- */
     .chat-messages::-webkit-scrollbar {
         width: 8px;
     }
 
     .chat-messages::-webkit-scrollbar-thumb {
         background-color: rgba(255, 255, 255, 0.15);
         border-radius: 4px;
     }
 
     .chat-messages::-webkit-scrollbar-thumb:hover {
         background-color: rgba(255, 255, 255, 0.25);
     }
 </style>
  
 
 </head>
 <body>
     <div class="chat-container">
         <div class="chat-header">
             <div style="position: relative;">
                 <span>ðŸ¤– AV ChatFriends</span>
                 <div class="status-indicator" id="statusIndicator"></div>
             </div>
         </div>
         <div class="chat-messages" id="chatMessages">
             <div class="message assistant">
                 <div class="message-content">
                     Hello! I'm your AI assistant. How can I help you today?
                 </div>
             </div>
         </div>
         <div class="chat-input-container">
             <div class="chat-input-wrapper">
                 <textarea 
                     id="chatInput" 
                     class="chat-input" 
                     placeholder="Type your message here..."
                     rows="1"
                     onkeydown="handleKeyDown(event)"
                 ></textarea>
                 <button id="sendButton" class="send-button" onclick="sendMessage()">Send</button>
             </div>
         </div>
     </div>
 
     <script>
         const chatMessages = document.getElementById('chatMessages');
         const chatInput = document.getElementById('chatInput');
         const sendButton = document.getElementById('sendButton');
         const statusIndicator = document.getElementById('statusIndicator');
 
         // Auto-resize textarea
         chatInput.addEventListener('input', function() {
             this.style.height = 'auto';
             this.style.height = Math.min(this.scrollHeight, 120) + 'px';
         });
 
         // Check server health on load
         checkHealth();
 
         async function checkHealth() {
             try {
                 const response = await fetch('/api/health');
                 const data = await response.json();
                 if (data.status === 'healthy') {
                     statusIndicator.classList.remove('disconnected');
                 } else {
                     statusIndicator.classList.add('disconnected');
                 }
             } catch (error) {
                 statusIndicator.classList.add('disconnected');
             }
         }
 
         function handleKeyDown(event) {
             if (event.key === 'Enter' && !event.shiftKey) {
                 event.preventDefault();
                 sendMessage();
             }
         }
 
         async function sendMessage() {
             const message = chatInput.value.trim();
             
             if (!message) {
                 return;
             }
 
             // Disable input and button
             chatInput.disabled = true;
             sendButton.disabled = true;
             sendButton.innerHTML = '<div class="loading"></div>';
 
             // Add user message to chat
             addMessage('user', message);
             chatInput.value = '';
             chatInput.style.height = 'auto';
 
             // Show loading indicator
             const loadingId = addMessage('assistant', '<div class="loading"></div>', true);
 
             try {
                 const response = await fetch('/api/chat', {
                     method: 'POST',
                     headers: {
                         'Content-Type': 'application/json',
                     },
                     body: JSON.stringify({
                         prompt: message
                     })
                 });
 
                 const data = await response.json();
 
                 // Remove loading indicator
                 removeMessage(loadingId);
 
                 if (data.success) {
                     addMessage('assistant', data.message);
                     statusIndicator.classList.remove('disconnected');
                 } else {
                     addMessage('assistant', `Error: ${data.error || 'Unknown error occurred'}`, false, true);
                     statusIndicator.classList.add('disconnected');
                 }
             } catch (error) {
                 // Remove loading indicator
                 removeMessage(loadingId);
                 
                 addMessage('assistant', `Connection error: ${error.message}. Please ensure the server is running.`, false, true);
                 statusIndicator.classList.add('disconnected');
             } finally {
                 // Re-enable input and button
                 chatInput.disabled = false;
                 sendButton.disabled = false;
                 sendButton.innerHTML = 'Send';
                 chatInput.focus();
             }
         }
 
         function addMessage(role, content, isLoading = false, isError = false) {
             const messageDiv = document.createElement('div');
             messageDiv.className = `message ${role}`;
             
             if (isLoading) {
                 messageDiv.id = 'loading-' + Date.now();
             }
             
             const contentDiv = document.createElement('div');
             contentDiv.className = 'message-content';
             
             if (isError) {
                 contentDiv.className += ' error-message';
             }
             
             contentDiv.innerHTML = content;
             messageDiv.appendChild(contentDiv);
             chatMessages.appendChild(messageDiv);
             
             // Scroll to bottom
             chatMessages.scrollTop = chatMessages.scrollHeight;
             
             return messageDiv.id;
         }
 
         function removeMessage(messageId) {
             const message = document.getElementById(messageId);
             if (message) {
                 message.remove();
             }
         }
     </script>
 </body>
 </html>
 
 